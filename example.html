<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cursor Rain Effect Demo</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            padding: 50px 20px;
        }
        
        h1 {
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        p {
            font-size: 1.2em;
            line-height: 1.6;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .demo-area {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .controls {
            margin-top: 30px;
        }
        
        button {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 24px;
            margin: 0 10px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        button:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .info {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div class="info">
        <strong>æç¤ºï¼š</strong>ç§»åŠ¨é¼ æ ‡æ¥çœ‹é›¨ç‚¹æ•ˆæœï¼<br>
        ä½¿ç”¨ä¸‹æ–¹æŒ‰é’®æ§åˆ¶æ•ˆæœå¼€å…³ã€‚
    </div>
    
    <div class="container">
        <h1>ğŸŒ§ï¸ Cursor Rain Effect</h1>
        <p>è¿™æ˜¯ä¸€ä¸ªè·Ÿéšå…‰æ ‡çš„é›¨ç‚¹æ•ˆæœæ¼”ç¤ºã€‚ç§»åŠ¨ä½ çš„é¼ æ ‡ï¼Œäº«å—ç¾ä¸½çš„é›¨æ»´åŠ¨ç”»ï¼</p>
        
        <div class="demo-area">
            <h2>æ¼”ç¤ºåŒºåŸŸ</h2>
            <p>åœ¨è¿™ä¸ªåŒºåŸŸç§»åŠ¨é¼ æ ‡ï¼Œè§‚å¯Ÿé›¨ç‚¹æ•ˆæœã€‚æ•ˆæœä½¿ç”¨ GSAP ä¼˜åŒ–ï¼Œæ€§èƒ½æµç•…ã€‚</p>
            <p>æ”¯æŒè‡ªå®šä¹‰é¢œè‰²ã€å¤§å°ã€æ•°é‡ç­‰å‚æ•°ï¼Œå®Œç¾å…¼å®¹ VitePress ç­‰ç°ä»£å‰ç«¯æ¡†æ¶ã€‚</p>
        </div>
        
        <div class="controls">
            <button onclick="toggleRain()">æš‚åœ/æ¢å¤ é›¨ç‚¹</button>
            <button onclick="changeColor()">æ›´æ¢é¢œè‰²</button>
            <button onclick="changeIntensity()">è°ƒæ•´å¼ºåº¦</button>
            <button onclick="changeVelocity()">è°ƒæ•´åˆé€Ÿåº¦</button>
        </div>
        
        <div class="demo-area">
            <h3>ğŸš€ æ–°åŠŸèƒ½ï¼šå¯è°ƒèŠ‚åˆé€Ÿåº¦</h3>
            <p><strong>åˆé€Ÿåº¦èŒƒå›´ï¼š</strong><span id="velocityDisplay">[100, 300] px/s</span></p>
            <p><strong>é‡åŠ›åŠ é€Ÿåº¦ï¼š</strong><span id="gravityDisplay">500 px/sÂ²</span></p>
            <p>ç‚¹å‡»"è°ƒæ•´åˆé€Ÿåº¦"æŒ‰é’®æ¥ä½“éªŒä¸åŒçš„é›¨æ»´ä¸‹è½æ•ˆæœï¼</p>
        </div>
    </div>

    <!-- GSAP CDN for demo -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <!-- Our rain effect (simulated for demo) -->
    <script>
        // æ¨¡æ‹Ÿæˆ‘ä»¬çš„åº“åŠŸèƒ½ç”¨äºæ¼”ç¤º
        class DemoRainEffect {
            constructor(options = {}) {
                this.options = {
                    maxDrops: options.maxDrops || 30,
                    dropSize: options.dropSize || [3, 8],
                    color: options.color || 'rgba(173, 216, 230, 0.8)',
                    duration: options.duration || [0.8, 1.5],
                    initialVelocity: options.initialVelocity || [100, 300],
                    gravity: options.gravity || 500,
                    enabled: true,
                    ...options
                };
                
                this.drops = [];
                this.container = null;
                this.animationPool = [];
                this.isEnabled = true;
                
                this.init();
            }
            
            init() {
                this.createContainer();
                this.preCreateDrops();
                this.setupEventListeners();
            }
            
            createContainer() {
                this.container = document.createElement('div');
                this.container.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100vw;
                    height: 100vh;
                    pointer-events: none;
                    z-index: 9999;
                    overflow: hidden;
                `;
                document.body.appendChild(this.container);
            }
            
            preCreateDrops() {
                for (let i = 0; i < this.options.maxDrops; i++) {
                    const drop = document.createElement('div');
                    drop.style.cssText = `
                        position: absolute;
                        background: ${this.options.color};
                        border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
                        pointer-events: none;
                        opacity: 0;
                    `;
                    this.animationPool.push(drop);
                    this.container.appendChild(drop);
                }
            }
            
            setupEventListeners() {
                this.mouseMoveHandler = this.throttle((e) => {
                    if (this.isEnabled) {
                        this.createRainAtPosition(e.clientX, e.clientY);
                    }
                }, 16);
                
                document.addEventListener('mousemove', this.mouseMoveHandler);
            }
            
            createRainAtPosition(x, y) {
                const availableDrop = this.animationPool.find(drop => 
                    gsap.getTweensOf(drop).length === 0
                );
                
                if (!availableDrop) return;
                
                const size = this.randomBetween(this.options.dropSize[0], this.options.dropSize[1]);
                const duration = this.randomBetween(this.options.duration[0], this.options.duration[1]);
                const offsetX = this.randomBetween(-20, 20);
                const offsetY = this.randomBetween(-10, 10);
                
                // è®¡ç®—ç‰©ç†å‚æ•°
                const fallDistance = window.innerHeight - y + 100;
                const initialVelocity = this.randomBetween(this.options.initialVelocity[0], this.options.initialVelocity[1]);
                const gravity = this.options.gravity;
                
                // ç®€åŒ–ç‰©ç†è®¡ç®—ï¼Œç¡®ä¿æ¼”ç¤ºæ­£å¸¸å·¥ä½œ
                const fallTime = Math.max(0.5, fallDistance / Math.max(initialVelocity, 100));
                
                gsap.set(availableDrop, {
                    x: x + offsetX - size / 2,
                    y: y + offsetY - size / 2,
                    width: size * 0.3,
                    height: size * 4,
                    opacity: 0,
                    scaleY: 0.1,
                    rotation: this.randomBetween(-15, 15)
                });
                
                const tl = gsap.timeline();
                tl.to(availableDrop, {
                    opacity: 1,
                    scaleY: 1,
                    duration: 0.1,
                    ease: 'power2.out'
                })
                .to(availableDrop, {
                    y: `+=${fallDistance}`,
                    x: `+=${this.randomBetween(-10, 10)}`,
                    scaleY: 1.5,
                    opacity: 0.3,
                    rotation: 0,
                    duration: Math.min(fallTime, duration * 2), // ä½¿ç”¨è®¡ç®—çš„ä¸‹è½æ—¶é—´
                    ease: 'power2.in'
                }, 0.05)
                .to(availableDrop, {
                    opacity: 0,
                    duration: 0.2,
                    ease: 'power2.out'
                }, '-=0.3');
            }
            
            enable() {
                this.isEnabled = true;
            }
            
            disable() {
                this.isEnabled = false;
            }
            
            updateOptions(newOptions) {
                this.options = { ...this.options, ...newOptions };
                
                // Update existing drops color
                this.animationPool.forEach(drop => {
                    drop.style.background = this.options.color;
                });
            }
            
            randomBetween(min, max) {
                return Math.random() * (max - min) + min;
            }
            
            throttle(func, delay) {
                let timeoutId;
                let lastExecTime = 0;
                
                return (...args) => {
                    const currentTime = Date.now();
                    
                    if (currentTime - lastExecTime > delay) {
                        func(...args);
                        lastExecTime = currentTime;
                    } else {
                        clearTimeout(timeoutId);
                        timeoutId = setTimeout(() => {
                            func(...args);
                            lastExecTime = Date.now();
                        }, delay - (currentTime - lastExecTime));
                    }
                };
            }
        }
        
        // åˆå§‹åŒ–é›¨ç‚¹æ•ˆæœ
        let rainEffect = new DemoRainEffect();
        
        // æ§åˆ¶å‡½æ•°
        let isEnabled = true;
        const colors = [
            'rgba(173, 216, 230, 0.8)',
            'rgba(255, 182, 193, 0.8)',
            'rgba(144, 238, 144, 0.8)',
            'rgba(255, 218, 185, 0.8)',
            'rgba(221, 160, 221, 0.8)'
        ];
        let colorIndex = 0;
        let intensityLevel = 0;
        const intensities = [
            { maxDrops: 30, dropSize: [3, 8] },
            { maxDrops: 15, dropSize: [2, 6] },
            { maxDrops: 50, dropSize: [4, 10] }
        ];
        
        let velocityLevel = 0;
        const velocitySettings = [
            { initialVelocity: [100, 300], gravity: 500, name: "æ­£å¸¸é€Ÿåº¦" },
            { initialVelocity: [50, 150], gravity: 300, name: "ç¼“æ…¢é£˜è½" },
            { initialVelocity: [200, 500], gravity: 800, name: "æ€¥é€Ÿä¸‹å " },
            { initialVelocity: [0, 50], gravity: 200, name: "è½»æŸ”é£˜æ•£" }
        ];
        
        function toggleRain() {
            isEnabled = !isEnabled;
            if (isEnabled) {
                rainEffect.enable();
            } else {
                rainEffect.disable();
            }
        }
        
        function changeColor() {
            colorIndex = (colorIndex + 1) % colors.length;
            rainEffect.updateOptions({ color: colors[colorIndex] });
        }
        
        function changeIntensity() {
            intensityLevel = (intensityLevel + 1) % intensities.length;
            const newIntensity = intensities[intensityLevel];
            rainEffect.updateOptions(newIntensity);
        }
        
        function changeVelocity() {
            velocityLevel = (velocityLevel + 1) % velocitySettings.length;
            const newVelocity = velocitySettings[velocityLevel];
            rainEffect.updateOptions({
                initialVelocity: newVelocity.initialVelocity,
                gravity: newVelocity.gravity
            });
            
            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('velocityDisplay').textContent = 
                `[${newVelocity.initialVelocity[0]}, ${newVelocity.initialVelocity[1]}] px/s (${newVelocity.name})`;
            document.getElementById('gravityDisplay').textContent = 
                `${newVelocity.gravity} px/sÂ²`;
        }
    </script>
</body>
</html>